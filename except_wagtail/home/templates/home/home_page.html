{% extends "base.html" %}
{% load wagtailcore_tags %}
{% load wagtailimages_tags wagtailembeds_tags %}

{% load static %}

{% block content %}
  {% with mediaPath="/media/" %}

    <section class="hero is-inverted is-darkened" style="background-image: url({{ mediaPath }}{{ page.hero_image }})">
      <div class="hero-body">
        <div class="container">
          <div>
            {% if page.hero_title %}
              <h1 class="h1 title">{{ page.hero_title }}</h1>
            {% endif %}
            {% if page.hero_subtitle %}
              <h3 class="h3 subtitle">{{ page.hero_subtitle }}</h3>
            {% endif %}
            <button class="button has-icon is-primary"><i class="fas fa-chevron-down"></i></button>
          </div>
        </div>
      </div>
    </section>

    {# Main navigation #}
    {% include "includes/navbar.html" %}

    <div class="spacer"></div>

    <section>
      <article class="container">
        {{ page.body|richtext }}
      </article>
    </section>

    {% comment %} {% if page.carousel_items %}
      {% for carousel_item in page.carousel_items.all %}
        <p>{{ carousel_item.image.file }}</p>
      {% endfor %}
    {% endif %} {% endcomment %}


    {% if page.carousel_items %}
      <div id="carousel" class="carousel slide" data-ride="carousel">
        {% if page.carousel_items|length > 1 %}
          <ol class="carousel-indicators">
            {% for carousel_item in page.carousel_items.all %}
              <li data-target="#carousel" data-slide-to="{{ forloop.counter0 }}"{% if forloop.first %} class="active"{% endif %}></li>
            {% endfor %}
          </ol>
        {% endif %}

        <div class="carousel-inner" role="listbox">
          {% for carousel_item in page.carousel_items.all %}
            <div class="item{% if forloop.first %} active{% endif %}">
              
              {# Carousel image - first store image as a variable in order to construct an image tag with a title applied (title is used by bxslider js to construct the caption) #}
              {% image carousel_item.image width-1000 as carouselimagedata %}
              <img src="{{ carouselimagedata.url }}" style="width: 100%; min-height: {{ carouselimagedata.height }}px;" alt="{{ carouselimagedata.alt }}" />

              {% if carousel_item.caption or carousel_item.link %}
                <div class="carousel-caption">
                  <h3>{{ carousel_item.caption }}</h3>
                  {% if carousel_item.link %}
                    <a href="{{ carousel_item.link }}" class="btn btn-primary">Open</a>
                  {% endif %}
                </div>
              {% endif %}
            </div>
          {% endfor %}
        </div>

        {% if carousel_items|length > 1 %}
          <a class="left carousel-control" href="#carousel" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="right carousel-control" href="#carousel" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        {% endif %}
      </div>
    {% endif %}

  {% endwith %}
{% endblock content %}